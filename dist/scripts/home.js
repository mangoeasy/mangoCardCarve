function convertCanvasToImage(e){var a=new Image;return a.src=e.toDataURL("image/png"),a}function convertImageToCanvas(e){var a=document.createElement("canvas");return a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(e,0,0),a}var Home={viewModel:{cardTypes:ko.observableArray(),employees:ko.observableArray(),wechatuser:{Id:ko.observable(),NickName:ko.observable(),Gender:ko.observable(),Language:ko.observable(),City:ko.observable(),Province:ko.observable(),Country:ko.observable(),Headimgurl:ko.observable()}}};ko.bindingHandlers.qrbind={init:function(e,a,o,n){},update:function(e,a){var o=ko.unwrap(a()),n=window.location.href+"demo.html?id="+o,i=$(e).find(".work-canvas-link");$(e).find(".work-canvas-link").qrcode(n).find("canvas").hide(),i.attr("href","#").on("click",function(e){e.preventDefault();var a=$(this),o=convertCanvasToImage(a.find("canvas")[0]),n='<div class="mfp-figure"><figure>'+$(o).addClass("mfp-img").prop("outerHTML")+"</figure></div>";$.magnificPopup.open({items:{src:n,type:"inline"}})})}},ko.applyBindings(Home),$.get("http://api.card.mangoeasy.com/api/CardType/",function(e){ko.mapping.fromJS(e,{},Home.viewModel.cardTypes),$.get("http://api.card.mangoeasy.com/api/Employee/",function(e){ko.mapping.fromJS(e,{},Home.viewModel.employees),initWorkFilter(),$.get("http://api.card.mangoeasy.com/api/WeChatUser/",function(e){null!=e&&ko.mapping.fromJS(e,{},Home.viewModel.wechatuser)})})});